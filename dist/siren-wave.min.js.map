{"version":3,"sources":["siren-wave.js"],"names":["global","factory","exports","module","define","amd","Siren","this","extend","to","from","keys","Object","i","length","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","protoProps","staticProps","prototype","Config","value","options","arguments","undefined","opt","params","width","height","bgColor","waves","color","callback","Wave","xPos","yPos","yEnd","xEnd","xStep","angleStep","angle","alpha","peak","yOffset","speed","count","Math","PI","isPositive","x1","y1","x2","y2","sqrt","pow","ctx","save","globalAlpha","getAngle","beginPath","nextXPos","nextYPos","sin","nextAngle","moveTo","lineTo","dist","closePath","stroke","restore","getOptions","waveList","getCanvasContext","timerId","strokeStyle","lineWidth","translate","createWaves","canvas","targetEl","document","getElementById","createElement","setAttribute","offsetHeight","offsetWidth","appendChild","querySelector","Error","getContext","_this","forEach","push","_this2","clearRect","wave","render","cancelAnimationFrame","requestAnimationFrame","draw","bind"],"mappings":"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","file":"siren-wave.min.js","sourcesContent":["/*!\n * siren-wave v0.0.2\n * (c) 2017 miaowing\n * Released under the MIT License.\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.Siren = factory());\n}(this, (function () { 'use strict';\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n\n\n\n\n\nvar get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar set = function set(object, property, value, receiver) {\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent !== null) {\n      set(parent, property, value, receiver);\n    }\n  } else if (\"value\" in desc && desc.writable) {\n    desc.value = value;\n  } else {\n    var setter = desc.set;\n\n    if (setter !== undefined) {\n      setter.call(receiver, value);\n    }\n  }\n\n  return value;\n};\n\n/**\n * Created by zhaofeng on 2016/10/31.\n */\nvar Config = function () {\n    function Config() {\n        classCallCheck(this, Config);\n    }\n\n    createClass(Config, null, [{\n        key: 'getOptions',\n        value: function getOptions() {\n            var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            var opt = {};\n            opt.params = options;\n\n            opt.target = options.target;\n            opt.width = options.width;\n            opt.height = options.height;\n            opt.bgColor = options.bgColor ? options.bgColor : 'white';\n            opt.waves = options.waves || [];\n            opt.color = options.color ? options.color : '#7cd5f4';\n            opt.callback = options.callback;\n\n            /*\n             move in waves.\n              opt.alpha = options.alpha && options.alpha.length > 1 ? options.alpha : [0.4, 0.2];\n             opt.speed = options.speed && options.speed.length > 1 ? options.speed : [0.01 * 0.4, 0.08 * 0.4];\n             opt.angleStep = options.angleStep || 0.01;\n             opt.peak = options.peak || 18;\n             opt.isPositive = options.isPositive || true;\n             */\n\n            return opt;\n        }\n    }]);\n    return Config;\n}();\n\n/**\n * Created by zhaofeng on 2016/11/1.\n */\nfunction extend(to, from) {\n    var keys = Object.keys(from);\n    var i = keys.length;\n    while (i--) {\n        to[keys[i]] = from[keys[i]];\n    }\n    return to;\n}\n\n/**\n * Created by zhaofeng on 2016/10/31.\n */\nvar Wave = function () {\n    function Wave() {\n        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        classCallCheck(this, Wave);\n\n        this.xPos = 0;\n        this.yPos = 0;\n        this.yEnd = options.yEnd || 0;\n        this.xEnd = options.xEnd || 0;\n        this.xStep = 1;\n        this.angleStep = options.angleStep || 0.01;\n        this.angle = 0;\n        this.alpha = options.alpha ? options.alpha : 1;\n        this.peak = options.peak ? options.peak : 18;\n        this.yOffset = options.yOffset ? options.yOffset : 0;\n        this.speed = options.speed ? options.speed : 0.06;\n        this.count = Math.PI / 2;\n        this.isPositive = options.isPositive || true;\n    }\n\n    createClass(Wave, [{\n        key: 'getAngle',\n        value: function getAngle() {\n            this.count += this.speed;\n            return this.count;\n        }\n    }, {\n        key: 'dist',\n        value: function dist(x1, y1, x2, y2) {\n            x2 = x2 ? x2 : 0;\n            y2 = y2 ? y2 : 0;\n            return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n        }\n    }, {\n        key: 'render',\n        value: function render(ctx) {\n            ctx.save();\n            ctx.globalAlpha = this.alpha;\n\n            this.angle = this.getAngle();\n            this.xPos = -this.xEnd / 2;\n            this.yPos = 0;\n\n            ctx.beginPath();\n\n            while (this.xPos < this.xEnd) {\n                var nextXPos = this.xPos + this.xStep;\n                var nextYPos = Math.sin(this.angle) * this.peak + this.yOffset;\n                var nextAngle = this.isPositive ? this.angle - this.angleStep : this.angle + this.angleStep;\n\n                ctx.moveTo(this.xPos - 0.5, this.yPos);\n                ctx.lineTo(this.xPos - 0.5, this.yEnd);\n\n                this.xPos = nextXPos;\n                this.yPos = this.dist(nextXPos, nextYPos) < this.xEnd ? nextYPos : this.yEnd * (this.yOffset > 0 ? 1 : -1);\n                this.angle = nextAngle;\n            }\n\n            ctx.closePath();\n            ctx.stroke();\n            ctx.restore();\n        }\n    }, {\n        key: 'update',\n        value: function update(options) {\n            extend(this, options);\n        }\n    }]);\n    return Wave;\n}();\n\n/**\n * Created by zhaofeng on 2016/10/31.\n */\nvar Siren = function () {\n    function Siren() {\n        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        classCallCheck(this, Siren);\n\n        this.options = Config.getOptions(options);\n        this.waveList = [];\n        this.ctx = this.getCanvasContext();\n        this.timerId = null;\n\n        this.ctx.strokeStyle = this.options.color;\n        this.ctx.lineWidth = 1;\n        this.ctx.translate(this.options.width / 2, this.options.height / 2);\n\n        this.createWaves();\n    }\n\n    createClass(Siren, [{\n        key: 'getCanvasContext',\n        value: function getCanvasContext() {\n            this.canvas = null;\n            var targetEl = document.getElementById(this.options.target);\n            if (targetEl) {\n                this.canvas = document.createElement(\"canvas\");\n                this.canvas.setAttribute(\"height\", this.options.height || targetEl.offsetHeight);\n                this.canvas.setAttribute(\"width\", this.options.width || targetEl.offsetWidth);\n                targetEl.appendChild(this.canvas);\n            } else {\n                this.canvas = document.querySelector('canvas');\n            }\n\n            if (!this.canvas) throw new Error('cannot find canvas');\n\n            return this.canvas.getContext('2d');\n        }\n    }, {\n        key: 'createWaves',\n        value: function createWaves() {\n            var _this = this;\n\n            this.waveList = [];\n            this.waves = this.options.waves;\n\n            this.waves.forEach(function (opt) {\n                _this.waveList.push(new Wave({\n                    alpha: opt.alpha,\n                    yOffset: opt.yOffset,\n                    yEnd: _this.options.height,\n                    xEnd: _this.options.width,\n                    speed: opt.speed,\n                    angleStep: opt.angleStep,\n                    peak: opt.peak,\n                    isPositive: opt.isPositive\n                }));\n            });\n        }\n    }, {\n        key: 'update',\n        value: function update(options) {\n            extend(this.options, options);\n\n            if (options.height) {\n                this.canvas.setAttribute('height', options.height);\n            }\n\n            if (options.width) {\n                this.canvas.setAttribute('width', options.width + '');\n            }\n\n            this.ctx.strokeStyle = this.options.color;\n            this.ctx.lineWidth = 1;\n            this.ctx.translate(this.options.width / 2, this.options.height / 2);\n            this.createWaves();\n        }\n    }, {\n        key: 'draw',\n        value: function draw() {\n            var _this2 = this;\n\n            this.ctx.clearRect(-this.options.width / 2, -this.options.height / 2, this.options.width, this.options.height);\n\n            this.waveList.forEach(function (wave) {\n                return wave.render(_this2.ctx);\n            });\n\n            cancelAnimationFrame(this.timerId);\n            this.timerId = requestAnimationFrame(this.draw.bind(this));\n        }\n    }]);\n    return Siren;\n}();\n\nreturn Siren;\n\n})));\n"]}