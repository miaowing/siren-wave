{"version":3,"sources":["siren-wave.js"],"names":["global","factory","exports","module","define","amd","Siren","this","extend","to","from","keys","Object","i","length","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","protoProps","staticProps","prototype","Config","value","options","arguments","undefined","opt","params","width","height","color","bgColor","alpha","callback","speed","angleStep","peak","isPositive","Wave","xPos","yPos","yEnd","xEnd","xStep","angle","yOffset","count","Math","PI","x1","y1","x2","y2","sqrt","pow","ctx","save","globalAlpha","getAngle","beginPath","nextXPos","nextYPos","sin","nextAngle","moveTo","lineTo","dist","closePath","stroke","restore","getOptions","getCanvasContext","timerId","strokeStyle","lineWidth","translate","createWaves","canvas","targetEl","document","getElementById","createElement","setAttribute","offsetHeight","offsetWidth","appendChild","querySelector","Error","getContext","waveFront","waveBehind","draw","clearRect","render","cancelAnimationFrame","requestAnimationFrame","bind"],"mappings":"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","file":"siren-wave.min.js","sourcesContent":["/*!\n * siren-wave v0.0.2\n * (c) 2017 miaowing\n * Released under the MIT License.\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.Siren = factory());\n}(this, (function () { 'use strict';\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n\n\n\n\n\nvar get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar set = function set(object, property, value, receiver) {\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent !== null) {\n      set(parent, property, value, receiver);\n    }\n  } else if (\"value\" in desc && desc.writable) {\n    desc.value = value;\n  } else {\n    var setter = desc.set;\n\n    if (setter !== undefined) {\n      setter.call(receiver, value);\n    }\n  }\n\n  return value;\n};\n\n/**\n * Created by zhaofeng on 2016/10/31.\n */\nvar Config = function () {\n    function Config() {\n        classCallCheck(this, Config);\n    }\n\n    createClass(Config, null, [{\n        key: 'getOptions',\n        value: function getOptions() {\n            var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            var opt = {};\n            opt.params = options;\n\n            opt.target = options.target;\n            opt.width = options.width;\n            opt.height = options.height;\n            opt.color = options.color ? options.color : '#7cd5f4';\n            opt.bgColor = options.bgColor ? options.bgColor : 'white';\n            opt.alpha = options.alpha && options.alpha.length > 1 ? options.alpha : [0.4, 0.2];\n            opt.callback = options.callback;\n            opt.speed = options.speed && options.speed.length > 1 ? options.speed : [0.01 * 0.4, 0.08 * 0.4];\n            opt.angleStep = options.angleStep || 0.01;\n            opt.peak = options.peak || 18;\n            opt.isPositive = options.isPositive || true;\n\n            return opt;\n        }\n    }]);\n    return Config;\n}();\n\n/**\n * Created by zhaofeng on 2016/11/1.\n */\nfunction extend(to, from) {\n    var keys = Object.keys(from);\n    var i = keys.length;\n    while (i--) {\n        to[keys[i]] = from[keys[i]];\n    }\n    return to;\n}\n\n/**\n * Created by zhaofeng on 2016/10/31.\n */\nvar Wave = function () {\n    function Wave() {\n        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        classCallCheck(this, Wave);\n\n        this.xPos = 0;\n        this.yPos = 0;\n        this.yEnd = options.yEnd || 0;\n        this.xEnd = options.xEnd || 0;\n        this.xStep = 1;\n        this.angleStep = options.angleStep || 0.01;\n        this.angle = 0;\n        this.alpha = options.alpha ? options.alpha : 1;\n        this.peak = options.peak ? options.peak : 18;\n        this.yOffset = options.yOffset ? options.yOffset : 0;\n        this.speed = options.speed ? options.speed : 0.06;\n        this.count = Math.PI / 2;\n        this.isPositive = options.isPositive || true;\n    }\n\n    createClass(Wave, [{\n        key: 'getAngle',\n        value: function getAngle() {\n            this.count += this.speed;\n            return this.count;\n        }\n    }, {\n        key: 'dist',\n        value: function dist(x1, y1, x2, y2) {\n            x2 = x2 ? x2 : 0;\n            y2 = y2 ? y2 : 0;\n            return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n        }\n    }, {\n        key: 'render',\n        value: function render(ctx) {\n            ctx.save();\n            ctx.globalAlpha = this.alpha;\n\n            this.angle = this.getAngle();\n            this.xPos = -this.xEnd / 2;\n            this.yPos = 0;\n\n            ctx.beginPath();\n\n            while (this.xPos < this.xEnd) {\n                var nextXPos = this.xPos + this.xStep;\n                var nextYPos = Math.sin(this.angle) * this.peak + this.yOffset;\n                var nextAngle = this.isPositive ? this.angle - this.angleStep : this.angle + this.angleStep;\n\n                ctx.moveTo(this.xPos - 0.5, this.yPos);\n                ctx.lineTo(this.xPos - 0.5, this.yEnd);\n\n                this.xPos = nextXPos;\n                this.yPos = this.dist(nextXPos, nextYPos) < this.xEnd ? nextYPos : this.yEnd * (this.yOffset > 0 ? 1 : -1);\n                this.angle = nextAngle;\n            }\n\n            ctx.closePath();\n            ctx.stroke();\n            ctx.restore();\n        }\n    }, {\n        key: 'update',\n        value: function update(options) {\n            extend(this, options);\n        }\n    }]);\n    return Wave;\n}();\n\n/**\n * Created by zhaofeng on 2016/10/31.\n */\nvar Siren = function () {\n    function Siren() {\n        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        classCallCheck(this, Siren);\n\n        this.options = Config.getOptions(options);\n        this.ctx = this.getCanvasContext();\n        this.timerId = null;\n\n        this.ctx.strokeStyle = this.options.color;\n        this.ctx.lineWidth = 1;\n        this.ctx.translate(this.options.width / 2, this.options.height / 2);\n\n        this.createWaves();\n    }\n\n    createClass(Siren, [{\n        key: 'getCanvasContext',\n        value: function getCanvasContext() {\n            this.canvas = null;\n            var targetEl = document.getElementById(this.options.target);\n            if (targetEl) {\n                this.canvas = document.createElement(\"canvas\");\n                this.canvas.setAttribute(\"height\", this.options.height || targetEl.offsetHeight);\n                this.canvas.setAttribute(\"width\", this.options.width || targetEl.offsetWidth);\n                targetEl.appendChild(this.canvas);\n            } else {\n                this.canvas = document.querySelector('canvas');\n            }\n\n            if (!this.canvas) throw new Error('cannot find canvas');\n\n            return this.canvas.getContext('2d');\n        }\n    }, {\n        key: 'createWaves',\n        value: function createWaves() {\n            this.waveFront = new Wave({\n                alpha: this.options.alpha[0],\n                yOffset: 0,\n                yEnd: this.options.height,\n                xEnd: this.options.width,\n                speed: this.options.speed[0],\n                angleStep: this.options.angleStep,\n                peak: this.options.peak,\n                isPositive: this.options.isPositive\n            });\n\n            this.waveBehind = new Wave({\n                alpha: this.options.alpha[1],\n                yOffset: -4,\n                yEnd: this.options.height,\n                xEnd: this.options.width,\n                speed: this.options.speed[1],\n                angleStep: this.options.angleStep,\n                peak: this.options.peak,\n                isPositive: this.options.isPositive\n            });\n        }\n    }, {\n        key: 'update',\n        value: function update(options) {\n            extend(this.options, options);\n\n            if (options.height) {\n                this.canvas.setAttribute('height', options.height);\n            }\n\n            if (options.width) {\n                this.canvas.setAttribute('width', options.width + '');\n            }\n\n            this.ctx.strokeStyle = this.options.color;\n            this.ctx.lineWidth = 1;\n            this.ctx.translate(this.options.width / 2, this.options.height / 2);\n            this.createWaves();\n            this.draw();\n        }\n    }, {\n        key: 'draw',\n        value: function draw() {\n            this.ctx.clearRect(-this.options.width / 2, -this.options.height / 2, this.options.width, this.options.height);\n\n            this.waveBehind.render(this.ctx);\n            this.waveFront.render(this.ctx);\n\n            cancelAnimationFrame(this.timerId);\n            this.timerId = requestAnimationFrame(this.draw.bind(this));\n        }\n    }]);\n    return Siren;\n}();\n\nreturn Siren;\n\n})));\n"]}